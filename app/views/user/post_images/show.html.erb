<div class="container">
  <div class="d-flex flex justify-content-center">
    <div class="mt-3">
    <% if flash[:notice] %>
      <p id = "notice">
        <%= flash[:notice] %>
      </p>
    <% end %>
    <% if @error_comment.present? %>
      <div id="error_explanation" >
        <h3><%= @error_comment.errors.count %>件のエラーが発生しました</h3>
        <ul>
          <% @error_comment.errors.full_messages.each do | message | %>
          <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>
    </div>
  </div>

  <%= render 'post_image',post_image: @post_image, user: @user %>

  <div class="d-flex flex-column">
    <div class="my-5 ml-auto">
      <% if @post_image.favorited_by?(current_user) %>
        <h3>
          <%= link_to user_post_image_favorite_path(@post_image), class: "text-reset", method: :delete do %>
            <i class="fas fa-heart"></i>  <%= @post_image.favorites.count %> いいね
          <% end %>
        </h3>
      <% elsif @post_image.user.is_active == true %>
        <h3>
          <%= link_to user_post_image_favorite_path(@post_image), class: "text-reset", method: :post do %>
            <i class="far fa-heart"></i>  <%= @post_image.favorites.count %> いいね
          <% end %>
        </h3>
      <% end %>
    </div>
    <div class="comment-field">
      <% if @post_image.user.is_active == true %>
        <%= form_with model: [@post_image, @post_comment],url: user_post_image_post_comments_path(@post_image.id), method: :post do |f| %>
          <%= f. text_area :comment , placeholder: "コメントをここに" , class: "form-control" %>
            <%= f. submit "送信する" , class: "btn btn-success btn-sm mt-3"%>
          <% end %>
      <% end %>
    </div>

    <%= render 'comment', post_image: @post_image %>

  </div>
</div>
